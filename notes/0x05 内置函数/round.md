# round

> GitHub@[orca-j35](https://github.com/orca-j35)ï¼Œæ‰€æœ‰ç¬”è®°å‡æ‰˜ç®¡äºŽ [python_notes](https://github.com/orca-j35/python_notes) ä»“åº“

ðŸ”¨ round(*number*[, *ndigits*])

è¯¥å‡½æ•°ç”¨äºŽå¯¹ *number* è¿›è¡Œèˆå…¥ï¼Œ*ndigits* ç”¨äºŽè®¾ç½®ç²¾åº¦ã€‚

*ndigits* å¯ä»¥æ˜¯ä»»æ„æ•´æ•°å€¼(æ­£æ•°ã€0ã€è´Ÿæ•°å‡å¯)ã€‚å½“ *ndigits* è¢«çœç•¥(æˆ–å€¼ä¸º `None`)æ—¶ï¼Œå°†è¿”å›žè· *number* æœ€è¿‘çš„æ•´æ•°ï¼›å½“ä¼ å…¥ *ndigits* å‚æ•°æ—¶ï¼Œå°†è¿”å›žä¸Ž *number* åŒç±»åž‹çš„å€¼ã€‚

```python
# æ³¨æ„è§‚å¯Ÿè¿”å›žå€¼ç±»åž‹çš„ç±»åž‹
round(1.4), round(1.5) #> (1, 2)
round(1.4,0), round(1.5,0) #> (1.0, 2.0)
```

å¯¹äºŽæ”¯æŒ `round()` çš„å†…ç½®ç±»åž‹ï¼Œèˆå…¥ç»“æžœæ˜¯è·ç¦» *number* æœ€è¿‘çš„æŸä¸ª $10^{-ndigits}$ çš„å€æ•°ã€‚

```python
# å½“ndigits=1æ—¶ï¼Œèˆå…¥ç»“æžœåº”æ˜¯pow(10,-1)=0.1çš„å€æ•°ï¼Œä¸”æ˜¯æœ€æŽ¥è¿‘numberçš„æŸä¸ª0.1çš„å€æ•°
round(0.24,1), round(-0.24,1)
#> (0.2, -0.2)

# å¦‚æžœndigits<1ï¼Œä¾¿å¯å¯¹æ•´æ•°éƒ¨åˆ†è¿›è¡Œèˆå…¥
round(1024.61,-1),round(1024.61,-4),round(1024.61,-10)
#> (1020.0, 0.0, 0.0)
round(1024,-1),round(1024,-4),round(1024,-6)
#> (1020, 0, 0)
```

å¦‚æžœå­˜åœ¨ä¸¤ä¸ªä¸Ž *number* è·ç¦»ç›¸ç­‰çš„ $10^{-ndigits}$ çš„å€æ•°ï¼Œåˆ™ä¼šå‘å¶æ•°æ–¹å‘è¿›è¡Œèˆå…¥ã€‚

```python
# å½“ndigits=0æ—¶ï¼Œèˆå…¥ç»“æžœåº”æ˜¯pow(10,0)çš„å€æ•°ï¼Œä¸”æ˜¯æœ€æŽ¥è¿‘numberçš„çš„æŸä¸ª1çš„å€æ•°
# ä¸Ž0.5çš„è·ç¦»ç›¸ç­‰çš„æ•°æœ‰0å’Œ1ï¼Œæ­¤æ—¶å‘å¶æ•°æ–¹å‘èˆå…¥ï¼Œç»“æžœä¸º0
# ä¸Ž0.5çš„è·ç¦»ç›¸ç­‰çš„æ•°æœ‰0å’Œ-1ï¼Œæ­¤æ—¶å‘å¶æ•°æ–¹å‘èˆå…¥ï¼Œç»“æžœä¸º0
round(0.5,0), round(-0.5,0) #> (0.0, -0.0)
# ä¸Ž1.5çš„è·ç¦»ç›¸ç­‰çš„æ•°æœ‰1å’Œ2ï¼Œæ­¤æ—¶å‘å¶æ•°æ–¹å‘èˆå…¥ï¼Œç»“æžœä¸º2
# ä¸Ž-1.5çš„è·ç¦»ç›¸ç­‰çš„æ•°æœ‰-1å’Œ-2ï¼Œæ­¤æ—¶å‘å¶æ•°æ–¹å‘èˆå…¥ï¼Œç»“æžœä¸º-2
round(1.5,0), round(-1.5,0) #> (2.0, -2.0)
# ä¸Ž2.5çš„è·ç¦»ç›¸ç­‰çš„æ•°æœ‰2å’Œ3ï¼Œæ­¤æ—¶å‘å¶æ•°æ–¹å‘èˆå…¥ï¼Œç»“æžœä¸º2
# ä¸Ž-2.5çš„è·ç¦»ç›¸ç­‰çš„æ•°æœ‰-2å’Œ-3ï¼Œæ­¤æ—¶å‘å¶æ•°æ–¹å‘èˆå…¥ï¼Œç»“æžœä¸º-2
round(2.5,0), round(-2.5,0) #> (2.0, -2.0)
```

åœ¨è¿›è¡Œèˆå…¥æ—¶ï¼Œè¿˜åº”è€ƒè™‘åˆ°æµ®ç‚¹è¿ç®—å­˜åœ¨çš„é™åˆ¶ï¼šåè¿›åˆ¶æ•°çš„å°æ•°éƒ¨åˆ†å¤§å¤šä¸èƒ½ä½¿ç”¨æµ®ç‚¹æ•°ç²¾ç¡®è¡¨ç¤º(å¯é˜…è¯» [Floating Point Arithmetic: Issues and Limitations](https://docs.python.org/3.7/tutorial/floatingpoint.html#tut-fp-issues))ã€‚æ¯”å¦‚åœ¨ä¸‹é¢è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå®žé™…ä¸Šæµ®ç‚¹æ•° `2.675` ç¦» `2.67` æ›´è¿‘ï¼Œå› æ­¤èˆå…¥ç»“æžœæ˜¯ `2.67` è€Œä¸æ˜¯æˆ‘ä»¬é¢„æœŸä¸­çš„ `2.68`ã€‚

```python
# å½“ndigits=2æ—¶ï¼Œèˆå…¥ç»“æžœåº”æ˜¯pow(10,-2)çš„å€æ•°ï¼Œä¸”æ˜¯æœ€æŽ¥è¿‘numberçš„æŸä¸ª0.01çš„å€æ•°
# ä½†æµ®ç‚¹æ•°å¹¶ä¸èƒ½å‡†ç¡®è¡¨ç¤ºåè¿›åˆ¶å°æ•°ï¼Œå®žé™…ä¸Š2.675æ›´æŽ¥è¿‘2.67
format(2.675,'.20'),round(2.675, 2)
#> ('2.6749999999999998224', 2.67)

# å½“ndigits=1æ—¶ï¼Œèˆå…¥ç»“æžœåº”æ˜¯pow(10,-1)çš„å€æ•°ï¼Œä¸”æ˜¯æœ€æŽ¥è¿‘numberçš„æŸä¸ª0.1çš„å€æ•°
# ä½†æµ®ç‚¹æ•°å¹¶ä¸èƒ½å‡†ç¡®è¡¨ç¤ºåè¿›åˆ¶å°æ•°ï¼Œå®žé™…ä¸Š0.15æ›´æŽ¥è¿‘0.1ï¼Œ-0.15æ›´æŽ¥è¿‘-0.1
format(0.15,'.20'),round(0.15,1), round(-0.15,1)
#> ('0.14999999999999999445', 0.1, -0.1)
# åŒç†ï¼Œæµ®ç‚¹æ•°å¹¶ä¸èƒ½å‡†ç¡®è¡¨ç¤ºåè¿›åˆ¶å°æ•°ï¼Œå®žé™…ä¸Š0.35æ›´æŽ¥è¿‘0.3ï¼Œ-0.35æ›´æŽ¥è¿‘-0.3
format(0.35,'.20'),round(0.35,1), round(-0.35,1)
#> ('0.3499999999999999778', 0.3, -0.3)

# 0.25å¯è¢«ç²¾ç¡®è¡¨ç¤ºï¼Œ0.25ä¸Ž0.2å’Œ0.3è·ç¦»ç›¸ç­‰ï¼Œæ­¤æ—¶å‘å¶æ•°æ–¹å‘èˆå…¥ï¼Œç»“æžœä¸º0.2
# -0.25å¯è¢«ç²¾ç¡®è¡¨ç¤ºï¼Œ-0.25ä¸Ž-0.2å’Œ0-.3è·ç¦»ç›¸ç­‰ï¼Œæ­¤æ—¶å‘å¶æ•°æ–¹å‘èˆå…¥ï¼Œç»“æžœä¸º-0.2
format(0.25,'.20'),round(0.25,1), round(-0.25,1)
#> ('0.25', 0.2, -0.2)
```

å‚è€ƒï¼š[pythonä¸­å…³äºŽroundå‡½æ•°çš„å°å‘](https://www.cnblogs.com/anpengapple/p/6507271.html)

## \_\_round\_\_

å¯¹äºŽä¸€èˆ¬çš„ Python `number` å¯¹è±¡ï¼Œ`round` å‡½æ•°ä¼šå§”æ‰˜ `number.__round__` å®Œæˆèˆå…¥ï¼š

```python
class Foo:
    def __round__(self):
        return 61
round(Foo()) #> 61
```

è¿˜å¯é˜…è¯» [`object.__round__(self[, ndigits])`](https://docs.python.org/3.7/reference/datamodel.html#object.__round__)

## Py2 vs. Py3

### è¿”å›žå€¼çš„ç±»åž‹

åœ¨ Py2 ä¸­ï¼Œå¦‚æžœçœç•¥ *ndigits* å‚æ•°ï¼Œåˆ™ä¼šé»˜è®¤ `ndigits=0`ã€‚æ— è®ºæ˜¯å¦ä¼ å…¥ *ndigits*ï¼Œç»“æžœå§‹ç»ˆæ˜¯æµ®ç‚¹æ•°ã€‚

```python
# in Py2
round(1.4), round(10,2)
#> (1.0, 10.0)
```

åœ¨ Py3 ä¸­ï¼Œå¦‚æžœçœç•¥ *ndigits* å‚æ•°ï¼Œåˆ™ä¼šè¿”å›žè· *number* æœ€è¿‘çš„æ•´æ•°ï¼›å¦‚æžœä¼ å…¥ *ndigits* å‚æ•°ï¼Œåˆ™è¿”å›žä¸Ž *number* åŒç±»åž‹çš„å€¼ã€‚

```python
# in Py3
round(1.4), round(1.4,0), round(10,2)
#> (1, 1.0, 10)
```

### èˆå…¥æ–¹å‘

åœ¨ Py2 ä¸­ï¼Œå¦‚æžœå­˜åœ¨ä¸¤ä¸ªä¸Ž *number* è·ç¦»ç›¸ç­‰çš„ $10^{-ndigits}$ çš„å€æ•°ï¼Œåˆ™ä¼šå‘è¿œç¦» 0 çš„æ–¹å‘è¿›è¡Œèˆå…¥ã€‚

```python
round(0.5,0), round(-0.5,0) #> (1.0, -1.0)
round(1.5,0), round(-1.5,0) #> (2.0, -2.0)
round(2.5,0), round(-2.5,0) #> (3.0, -3.0)
```

åœ¨ Py3 ä¸­ï¼Œå¦‚æžœå­˜åœ¨ä¸¤ä¸ªä¸Ž *number* è·ç¦»ç›¸ç­‰çš„ $10^{-ndigits}$ çš„å€æ•°ï¼Œåˆ™ä¼šå‘å¶æ•°æ–¹å‘è¿›è¡Œèˆå…¥ã€‚

```python
round(0.5,0), round(-0.5,0) #> (0.0, -0.0)
round(1.5,0), round(-1.5,0) #> (2.0, -2.0)
round(2.5,0), round(-2.5,0) #> (2.0, -2.0)
```

